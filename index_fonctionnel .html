<!DOCTYPE html><html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Dessin anim√© ‚Äì Konrad (10 ans) tire au but</title>
  <style>
    :root{
      --ui: #111827; /* gris tr√®s fonc√© */
      --ui-2:#374151; /* gris */
      --accent:#2563eb; /* bleu */
      --grass:#0ea5e9; /* sera d√©grad√© -> vert via canvas */
      --sky:#93c5fd;
      --white:#ffffff;
      --shadow: 0 6px 20px rgba(0,0,0,.18);
    }
    html, body{
      margin:0; padding:0; height:100%; background:#0b1220; color:#0f172a; font-family: system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji";
    }
    .wrap{
      display:flex; flex-direction:column; gap:10px; min-height:100dvh; padding:10px; box-sizing:border-box;
    }
    header{
      display:flex; align-items:center; justify-content:space-between; gap:8px; background:#e5e7eb; border-radius:14px; padding:8px 12px; box-shadow: var(--shadow);
    }
    header .meta{display:flex; align-items:center; gap:10px; font-weight:600;}
    header .meta .badge{background:#111827; color:#fff; border-radius:999px; padding:4px 10px; font-size:12px; letter-spacing:.2px;}
    header .hint{font-size:12px; color:#111827; opacity:.8}.stage{
  position:relative; flex:1; min-height:60vh; background:#111827; border-radius:16px; overflow:hidden; box-shadow: var(--shadow);
}
canvas{ display:block; width:100%; height:100%; }

.hud{
  position:absolute; inset:0; pointer-events:none; display:flex; flex-direction:column; justify-content:space-between;
}
.hud .top, .hud .bottom{ display:flex; align-items:center; justify-content:space-between; padding:10px; }

.pill{ pointer-events:auto; user-select:none; border:none; background:#111827; color:#fff; border-radius:999px; padding:10px 14px; font-weight:700; letter-spacing:.3px; cursor:pointer; box-shadow: var(--shadow); display:inline-flex; align-items:center; gap:8px; }
.pill.secondary{ background:#374151; }
.pill:active{ transform: translateY(1px); }

.score{ pointer-events:none; background:rgba(255,255,255,.92); color:#111827; border-radius:12px; padding:8px 12px; font-weight:800; box-shadow: var(--shadow); }

.toast{
  position:absolute; left:50%; top:50%; transform:translate(-50%,-50%) scale(0.9); background:rgba(255,255,255,.97); color:#111827; border-radius:16px; padding:16px 22px; font-size:clamp(16px, 2vw, 22px); font-weight:900; letter-spacing:.6px; box-shadow: var(--shadow); opacity:0; transition:opacity .2s ease, transform .2s ease; white-space:nowrap;
}
.toast.show{ opacity:1; transform:translate(-50%,-50%) scale(1); }

.legend{
  pointer-events:none; position:absolute; left:12px; bottom:12px; background:rgba(255,255,255,.88); color:#111827; border-radius:12px; padding:10px 12px; font-size:12px; box-shadow: var(--shadow);
}
.legend b{ font-size:13px; }

  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="meta">
        <span class="badge">Dessin anim√©</span>
        <span>Konrad Rayad ‚Äì 10 ans ‚Äì Foot ‚öΩ</span>
      </div>
      <div class="hint">Astuce : touche/cliquer sur le terrain pour TIRER. üîä Sons d√©sactiv√©s (code pr√™t √† activer).</div>
    </header><div class="stage" id="stage">
  <canvas id="game"></canvas>
  <div class="hud">
    <div class="top">
      <button class="pill" id="shootBtn" title="Tirer (ou cliquer sur le terrain)">Tirer</button>
      <div class="score" id="scoreBox">Score : 0</div>
    </div>
    <div class="bottom">
      <button class="pill secondary" id="resetBtn" title="Rejouer">üîÅ Rejouer</button>
      <button class="pill secondary" id="toggleGuide">‚ùî Aide</button>
    </div>
  </div>
  <div class="toast" id="toast">BUT ! üéâ</div>
  <div class="legend" id="legend">
    <b>Contr√¥les</b><br/>
    ‚Ä¢ Cliquer/Toucher le terrain ou <b>Espace</b> : tirer<br/>
    ‚Ä¢ <b>R</b> : rejouer<br/>
    ‚Ä¢ Visez un coin du but : la cible varie √† chaque tir
  </div>
</div>

  </div><script>
(() => {
  // =======================
  //  Param√®tres g√©n√©raux
  // =======================
  const canvas = document.getElementById('game');
  const ctx = canvas.getContext('2d');
  const stage = document.getElementById('stage');
  const shootBtn = document.getElementById('shootBtn');
  const resetBtn = document.getElementById('resetBtn');
  const scoreBox = document.getElementById('scoreBox');
  const toast = document.getElementById('toast');
  const toggleGuide = document.getElementById('toggleGuide');
  const legend = document.getElementById('legend');

  let W = 1280, H = 720;   // taille logique; sera mise √† l'√©chelle

  // Etat du jeu
  const State = { IDLE: 0, FLY: 1, GOAL: 2, MISS: 3 };
  let state = State.IDLE;
  let score = 0;

  // Monde
  let groundY;           // y du sol
  let gravity;           // px/s^2

  // Joueur (Konrad, 10 ans)
  const player = {
    name: 'Konrad Rayad',
    age: 10,
    x: 0,
    y: 0,
    scale: 1,
  };

  // Ballon
  const ball = {
    x: 0,
    y: 0,
    r: 12,
    vx: 0,
    vy: 0,
    spin: 0,     // angle
    spinVel: 0,  // vitesse de rotation
    lastX: 0,
    lastY: 0,
  };

  // But
  const goal = {
    x: 0, y: 0, w: 0, h: 0,
    post: 8,
    impact: null,     // {x,y, t:time}
  };

  // Confettis pour c√©l√©bration
  const confetti = [];

  function resize(){
    const rect = stage.getBoundingClientRect();
    // Conserver un ratio panoramique ~16:9
    const targetW = rect.width;
    const targetH = rect.height;

    W = Math.floor(targetW * devicePixelRatio);
    H = Math.floor(targetH * devicePixelRatio);
    canvas.width = W; canvas.height = H;
    canvas.style.width = rect.width + 'px';
    canvas.style.height = rect.height + 'px';

    // Monde d√©pendant de H/W
    groundY = H * 0.80;
    gravity = H * 1.4; // px/s^2 proportionnel √† la hauteur

    // Positions cl√©s
    player.scale = Math.max(0.7, Math.min(1.2, H/720));
    player.x = W * 0.18;
    player.y = groundY;

    ball.r = Math.max(8, Math.min(18, H * 0.025));
    resetBall();

    goal.w = W * 0.18;
    goal.h = H * 0.38;
    goal.x = W - goal.w - W * 0.06; // marge droite
    goal.y = groundY - goal.h;      // pos√© sur le sol
  }

  function resetBall(){
    ball.x = player.x + 50 * player.scale;
    ball.y = player.y - ball.r - 6 * player.scale;
    ball.vx = 0; ball.vy = 0; ball.spin = 0; ball.spinVel = 0;
  }

  // =======================
  //  Dessin de la sc√®ne
  // =======================
  function drawBackground(){
    // Ciel d√©grad√©
    const sky = ctx.createLinearGradient(0,0,0,H);
    sky.addColorStop(0,'#90caf9');
    sky.addColorStop(1,'#e0f2fe');
    ctx.fillStyle = sky;
    ctx.fillRect(0,0,W,H);

    // Soleil
    ctx.beginPath();
    ctx.arc(W*0.08, H*0.12, Math.min(W,H)*0.06, 0, Math.PI*2);
    ctx.fillStyle = '#fde68a';
    ctx.fill();

    // Pelouse
    const grass = ctx.createLinearGradient(0,groundY,0,H);
    grass.addColorStop(0,'#16a34a');
    grass.addColorStop(1,'#065f46');
    ctx.fillStyle = grass;
    ctx.fillRect(0, groundY, W, H-groundY);

    // Lignes du terrain
    ctx.strokeStyle = 'rgba(255,255,255,.9)';
    ctx.lineWidth = 3 * devicePixelRatio;
    ctx.beginPath();
    // ligne de but
    ctx.moveTo(goal.x, groundY);
    ctx.lineTo(goal.x + goal.w, groundY);
    // cercle central (hors √©cran, d√©cor simplifi√©)
    ctx.stroke();
  }

  function drawGoal(){
    // Cage (montants)
    ctx.save();
    ctx.lineWidth = goal.post * devicePixelRatio;
    ctx.strokeStyle = '#ffffff';
    ctx.fillStyle = 'rgba(255,255,255,.12)';

    // Cadre
    ctx.strokeRect(goal.x, goal.y, goal.w, goal.h);

    // Filet (grille)
    const cols = 10, rows = 8;
    const dx = goal.w / cols, dy = goal.h / rows;

    // Ondulation locale du filet si impact r√©cent
    const now = performance.now();
    let tWave = 0, impactX = 0, impactY = 0;
    if(goal.impact){
      tWave = Math.max(0, 600 - (now - goal.impact.t));
      impactX = goal.impact.x; impactY = goal.impact.y;
      if(tWave <= 0) goal.impact = null;
    }

    ctx.beginPath();
    for(let i=1;i<cols;i++){
      const x = goal.x + i*dx;
      // d√©placement en y selon distance √† l'impact
      let extraY = 0;
      if(tWave>0){
        const d = Math.hypot(x - impactX, impactY - (goal.y + goal.h/2));
        extraY = Math.sin((now-goal.impact.t)/60) * Math.exp(-d/180) * 10 * devicePixelRatio;
      }
      ctx.moveTo(x, goal.y);
      ctx.lineTo(x, goal.y + goal.h + extraY);
    }
    for(let j=1;j<rows;j++){
      const y = goal.y + j*dy;
      let extraX = 0;
      if(tWave>0){
        const d = Math.hypot(impactY - y, impactX - (goal.x + goal.w/2));
        extraX = Math.sin((now-goal.impact.t)/70) * Math.exp(-d/180) * 8 * devicePixelRatio;
      }
      ctx.moveTo(goal.x, y);
      ctx.lineTo(goal.x + goal.w + extraX, y);
    }
    ctx.strokeStyle = 'rgba(255,255,255,.55)';
    ctx.lineWidth = 1.4 * devicePixelRatio;
    ctx.stroke();

    ctx.restore();
  }

  function drawPlayer(){
    const s = player.scale;
    const x = player.x, y = player.y;

    ctx.save();
    ctx.translate(x, y);

    // Ombre
    ctx.fillStyle = 'rgba(0,0,0,.2)';
    ctx.beginPath();
    ctx.ellipse(30*s, 2, 40*s, 10*s, 0, 0, Math.PI*2);
    ctx.fill();

    // Jambes
    ctx.strokeStyle = '#111827';
    ctx.lineWidth = 6*s*devicePixelRatio;
    ctx.lineCap = 'round';
    ctx.beginPath();
    ctx.moveTo(0, -10*s); ctx.lineTo(15*s, 0);
    ctx.moveTo(10*s, -12*s); ctx.lineTo(35*s, 0);
    ctx.stroke();

    // Short
    ctx.fillStyle = '#1e40af';
    ctx.fillRect(-8*s, -42*s, 40*s, 32*s);

    // Buste (maillot n¬∞10)
    ctx.fillStyle = '#3b82f6';
    ctx.fillRect(-12*s, -90*s, 48*s, 50*s);
    // Col
    ctx.fillStyle = '#1e3a8a';
    ctx.fillRect(-12*s, -90*s, 48*s, 8*s);
    // Num√©ro 10
    ctx.fillStyle = '#ffffff';
    ctx.font = `${18*s}px bold system-ui`;
    ctx.textAlign = 'center';
    ctx.fillText('10', 12*s, -57*s);

    // Bras
    ctx.strokeStyle = '#fcd9b8';
    ctx.lineWidth = 6*s*devicePixelRatio;
    ctx.beginPath();
    ctx.moveTo(36*s, -80*s); ctx.lineTo(56*s, -66*s); // bras droit vers le ballon
    ctx.moveTo(-10*s, -80*s); ctx.lineTo(-28*s, -66*s); // bras gauche
    ctx.stroke();

    // T√™te
    ctx.beginPath();
    ctx.arc(12*s, -110*s, 18*s, 0, Math.PI*2);
    ctx.fillStyle = '#fcd9b8';
    ctx.fill();

    // Cheveux
    ctx.fillStyle = '#111827';
    ctx.beginPath();
    ctx.arc(12*s, -118*s, 20*s, Math.PI*1.1, Math.PI*1.9);
    ctx.fill();

    // Yeux & sourire
    ctx.fillStyle = '#111827';
    ctx.beginPath(); ctx.arc(6*s, -112*s, 2.2*s, 0, Math.PI*2); ctx.fill();
    ctx.beginPath(); ctx.arc(18*s, -112*s, 2.2*s, 0, Math.PI*2); ctx.fill();
    ctx.strokeStyle = '#111827';
    ctx.lineWidth = 2*devicePixelRatio;
    ctx.beginPath(); ctx.arc(12*s, -105*s, 6*s, 0, Math.PI); ctx.stroke();

    ctx.restore();

    // L√©gende du joueur
    ctx.save();
    ctx.fillStyle = 'rgba(255,255,255,.9)';
    ctx.font = `${14*devicePixelRatio}px  system-ui`;
    ctx.fillText(`${player.name} ‚Äì 10 ans`, x - 6*devicePixelRatio, y - 125*s);
    ctx.restore();
  }

  function drawBall(){
    ctx.save();
    ctx.translate(ball.x, ball.y);
    ctx.rotate(ball.spin);

    // Ombre au sol
    const shadowY = groundY - ball.y;
    const shadowScale = Math.max(0.3, 1 - shadowY/300);
    ctx.save();
    ctx.translate(0, ball.r + 2);
    ctx.scale(1, 0.35*shadowScale);
    ctx.fillStyle = 'rgba(0,0,0,.25)';
    ctx.beginPath(); ctx.arc(0,0, ball.r*1.3, 0, Math.PI*2); ctx.fill();
    ctx.restore();

    // Ballon simple (patchs noirs)
    ctx.fillStyle = '#ffffff';
    ctx.beginPath(); ctx.arc(0,0, ball.r, 0, Math.PI*2); ctx.fill();
    ctx.lineWidth = 1.5*devicePixelRatio; ctx.strokeStyle = '#11182733'; ctx.stroke();

    ctx.strokeStyle = '#111827';
    for(let i=0;i<6;i++){
      ctx.rotate(Math.PI/3);
      ctx.beginPath();
      ctx.moveTo(0,0); ctx.lineTo(ball.r*0.9, 0);
      ctx.stroke();
    }
    ctx.restore();
  }

  function drawUI(){
    // Rien ici : l'UI HTML (boutons, score) est au-dessus du canvas
  }

  // =======================
  //  Tir et physique
  // =======================
  function randomIn(min,max){ return Math.random()*(max-min)+min; }

  function shoot(){
    if(state === State.FLY) return;
    // choisir une cible al√©atoire dans le but (coin sup√©rieur gauche/droit du cadre)
    const targetY = randomIn(goal.y + goal.h*0.15, goal.y + goal.h*0.6);
    const targetX = goal.x + randomIn(goal.w*0.1, goal.w*0.2); // juste derri√®re la ligne de but

    // Dur√©e de vol souhait√©e (s)
    const t = randomIn(0.95, 1.25);
    const dx = targetX - ball.x;
    const dy = targetY - ball.y;

    const g = gravity;
    const vx0 = dx / t;
    const vy0 = (dy - 0.5 * g * t*t) / t; // y vers le bas => vy0 peut √™tre n√©gatif

    ball.vx = vx0;
    ball.vy = vy0;
    ball.spinVel = (Math.sign(vx0) * randomIn(4, 8)); // rad/s

    state = State.FLY;
    hideToast();
  }

  function reset(){
    state = State.IDLE; resetBall();
  }

  // =======================
  //  Confettis
  // =======================
  function burst(x, y){
    confetti.length = 0;
    for(let i=0;i<80;i++){
      confetti.push({
        x, y,
        vx: Math.cos((i/80)*Math.PI*2) * randomIn(80, 260),
        vy: Math.sin((i/80)*Math.PI*2) * randomIn(80, 260) * -1,
        life: randomIn(500, 900),
        born: performance.now(),
        size: randomIn(2, 5) * devicePixelRatio
      });
    }
  }

  function drawConfetti(dt){
    const now = performance.now();
    for(const p of confetti){
      const age = now - p.born;
      if(age > p.life){ p.dead = true; continue; }
      // simple chute
      p.vy += gravity * 0.002 * (dt/16.7); // gravit√© r√©duite
      p.x += p.vx * (dt/1000);
      p.y += p.vy * (dt/1000);

      ctx.fillStyle = `hsl(${(age/4)%360} 80% 60%)`;
      ctx.fillRect(p.x, p.y, p.size, p.size);
    }
    // nettoyer
    for(let i=confetti.length-1;i>=0;i--) if(confetti[i].dead) confetti.splice(i,1);
  }

  // =======================
  //  Boucle d'animation
  // =======================
  let last = performance.now();
  function loop(){
    const now = performance.now();
    const dt = now - last; last = now; // ms

    // MAJ physique
    if(state === State.FLY){
      ball.lastX = ball.x; ball.lastY = ball.y;
      ball.vy += gravity * (dt/1000);
      ball.x += ball.vx * (dt/1000);
      ball.y += ball.vy * (dt/1000);
      ball.spin += ball.spinVel * (dt/1000);

      // Collision sol
      if(ball.y + ball.r >= groundY){
        ball.y = groundY - ball.r;
        state = State.MISS;
        showToast('Oups, √† c√¥t√©‚Ä¶ üòÖ');
      }
      
      // D√©tection franchissement ligne de but (x = goal.x)
      const crossed = (ball.lastX < goal.x && ball.x >= goal.x);
      const yAtLine = ball.lastY + (goal.x - ball.lastX) * (ball.y - ball.lastY) / (ball.x - ball.lastX + 1e-6);
      if(crossed && yAtLine >= goal.y && yAtLine <= goal.y + goal.h){
        state = State.GOAL;
        score += 1; scoreBox.textContent = `Score : ${score}`;
        showToast('BUT ! üéâ');
        goal.impact = {x: goal.x + goal.w*0.95, y: yAtLine, t: performance.now()};
        burst(goal.x + goal.w*0.6, yAtLine);
      }
    }

    // Dessin
    ctx.clearRect(0,0,W,H);
    drawBackground();
    drawGoal();
    drawPlayer();
    drawBall();
    drawConfetti(dt);

    requestAnimationFrame(loop);
  }

  // =======================
  //  UI & helpers
  // =======================
  function showToast(text){
    toast.textContent = text;
    toast.classList.add('show');
    // Dispara√Æt apr√®s 1.4s
    clearTimeout(showToast._t);
    showToast._t = setTimeout(()=>toast.classList.remove('show'), 1400);
  }
  function hideToast(){ toast.classList.remove('show'); }

  // √âv√©nements
  window.addEventListener('resize', resize);
  shootBtn.addEventListener('click', shoot);
  resetBtn.addEventListener('click', () => { reset(); showToast('Pr√™t ! üëü'); });
  toggleGuide.addEventListener('click', ()=>{
    legend.style.display = (legend.style.display === 'none' ? '' : 'none');
  });

  stage.addEventListener('pointerdown', (e)=>{
    // Tir si on clique dans la sc√®ne
    shoot();
  });

  window.addEventListener('keydown', (e)=>{
    if(e.code === 'Space') shoot();
    if(e.key.toLowerCase() === 'r') reset();
  });

  // Init
  resize();
  showToast('Clique pour tirer ! ü•Ö');
  loop();
})();
</script></body>
</html>
